<!DOCTYPE html>
<html lang="en-us">

  {% include head.html %}

  <body class="theme-base-0d layout-reverse">

    <button class="sidebar-toggle" type="button" aria-controls="site-sidebar" aria-expanded="false" aria-label="Open menu">
      <i class="fa-solid fa-bars" aria-hidden="true"></i>
      <span class="sr-only sidebar-toggle-label">Open menu</span>
    </button>
    {% include sidebar.html %}

    <div class="content container">
      {{ content }}
    </div>

    <script>
      (function () {
        var toggle = document.querySelector(".sidebar-toggle");
        var sidebar = document.getElementById("site-sidebar");
        var body = document.body;
        var icon = toggle ? toggle.querySelector(".fa-solid") : null;
        var label = toggle ? toggle.querySelector(".sidebar-toggle-label") : null;
        if (!toggle || !sidebar || !body) return;

        var isDesktop = function () {
          return window.matchMedia("(min-width: 48em)").matches;
        };

        var syncLabel = function (expanded) {
          var menuLabel = expanded ? "Close menu" : "Open menu";
          var sidebarHidden = !expanded && !isDesktop();
          toggle.setAttribute("aria-expanded", expanded ? "true" : "false");
          toggle.setAttribute("aria-label", menuLabel);
          sidebar.setAttribute("aria-hidden", sidebarHidden ? "true" : "false");
          if (label) label.textContent = menuLabel;
          if (icon) {
            icon.classList.toggle("fa-bars", !expanded);
            icon.classList.toggle("fa-xmark", expanded);
          }
        };

        toggle.addEventListener("click", function () {
          var expanded = body.classList.toggle("sidebar-open");
          syncLabel(expanded);
        });

        document.querySelectorAll("#site-sidebar a").forEach(function (link) {
          link.addEventListener("click", function () {
            if (!isDesktop()) {
              body.classList.remove("sidebar-open");
              syncLabel(false);
            }
          });
        });

        document.addEventListener("keydown", function (event) {
          if (event.key === "Escape" && body.classList.contains("sidebar-open")) {
            body.classList.remove("sidebar-open");
            syncLabel(false);
          }
        });

        window.addEventListener("resize", function () {
          if (isDesktop()) {
            body.classList.remove("sidebar-open");
            syncLabel(false);
            return;
          }
          syncLabel(body.classList.contains("sidebar-open"));
        });

        syncLabel(false);
      })();
    </script>

  </body>
</html>
